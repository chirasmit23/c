<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Downloader</title>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            function handleFormSubmission(formId, endpoint, messageId) {
                const form = document.getElementById(formId);
                const message = document.getElementById(messageId);

                form.addEventListener("submit", function (event) {
                    event.preventDefault(); // Prevent page refresh

                    let formData = new FormData(form);
                    message.textContent = "Downloading... Please wait.";

                    fetch(endpoint, {
                        method: "POST",
                        body: formData
                    })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            let link = document.createElement("a");
                            link.href = data.file_url;
                            link.download = "downloaded_media.mp4";
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);

                            message.textContent = "Download successful!";
                        } else {
                            message.textContent = "Error: " + (data.error || "Download failed.");
                        }
                    })
                    .catch(error => {
                        console.error("Error:", error);
                        message.textContent = "Download failed. Try again.";
                    });
                });
            }

            handleFormSubmission("instagramDownloadForm", "/instagram", "instaStatus");
            handleFormSubmission("videoDownloadForm", "/video", "videoStatus");
        });
    </script>
</head>
<body>

    <h1>Instagram Post Downloader</h1>
    <form id="instagramDownloadForm">
        <label for="insta_url">Enter Instagram Post URL:</label>
        <input type="text" id="insta_url" name="url" required>
        <button type="submit">Download Instagram Post</button>
    </form>
    <p id="instaStatus"></p>

    <h1>Video Downloader (YouTube, Reels, etc.)</h1>
    <form id="videoDownloadForm">
        <label for="video_url">Enter Video URL:</label>
        <input type="text" id="video_url" name="video_url" required>
        <label for="quality">Select Quality:</label>
        <select id="quality" name="quality">
            <option value="best">Best</option>
            <option value="1080">1080p</option>
            <option value="720">720p</option>
            <option value="480">480p</option>
        </select>
        <button type="submit">Download Video</button>
    </form>
    <p id="videoStatus"></p>

</body>
</html>
